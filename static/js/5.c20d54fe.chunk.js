(this.webpackJsonp=this.webpackJsonp||[]).push([[5],{438:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(4),a=n.n(r),i=n(1),l=n.n(i),c=n(448),u=n.n(c),o=n(63);function s(e){return l.a.createElement(o.f,a()({ModalComponent:f},e),e.children)}function f(e){return l.a.createElement(u.a,a()({ariaHideApp:!1},e),e.children)}},440:function(e,t,n){"use strict";n.d(t,"b",(function(){return l})),n.d(t,"a",(function(){return c}));var r=n(64),a=n.n(r),i=/^\d{2}\/\d{2}\/\d{4}$/,l=function(e){if(!i.test(e))throw new Error("date must have the form dd/mm/yyyy");var t=e.split("/"),n=a()(t,3),r=n[0],l=n[1],c=n[2],u=new Date;return u.setUTCDate(Number(r)),u.setUTCMonth(Number(l)-1),u.setUTCFullYear(Number(c)),u.getTime()},c=function(e){var t=new Date(e),n=t.getUTCDate(),r=n<10?"0"+n:""+n,a=t.getUTCMonth()+1;return r+"/"+(a<10?"0"+a:""+a)+"/"+t.getFullYear()}},507:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return ae}));var r,a=n(1),i=n.n(a),l=n(40),c=n(91);!function(e){e.dry="dry",e["medium dry"]="medium dry",e["medium sweet"]="medium sweet",e.sweet="sweet"}(r||(r={}));var u=n(7),o=n.n(u),s=n(111),f=n(3),m=n(2),d=n(8),b=n(437),p=n(63);function w(e){var t=Object(b.b)(),n=t.setFieldValue,r=t.values,l=Object(a.useCallback)((function(t){n(e.wineField,t,!1)}),[]);return i.a.createElement(p.e,{label:e.wineField,value:String(r[e.wineField]||""),onChangeText:l})}var y=n(64),v=n.n(y),g=n(440);function h(){var e=Object(b.b)(),t=e.values,n=e.setFieldValue,r=e.setFieldError,l=e.errors,c=Object(a.useState)(Object(g.a)(t.date)),u=v()(c,2),o=u[0],s=u[1],f=Object(a.useCallback)((function(e){s(e);try{n("date",Object(g.b)(e))}catch(t){r("date",t.message)}}),[s]);return i.a.createElement(p.e,{label:"Date",value:o,onChangeText:f,errorMessage:l.date})}var E=n(12),O=n.n(E),j=n(13),C=n.n(j),x=n(15),S=n.n(x),P=n(16),k=n.n(P),F=n(10),R=n.n(F),T=n(504);function V(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var a=R()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return k()(this,n)}}function D(){return i.a.createElement(p.e,{label:"Sweetness",InputComponent:B})}var B=function(e){S()(n,e);var t=V(n);function n(){return O()(this,n),t.apply(this,arguments)}return C()(n,[{key:"render",value:function(){return i.a.createElement(A,null)}}]),n}(i.a.Component);function A(){var e=Object(b.b)(),t=e.setFieldValue,n=e.values,l=Object(a.useCallback)((function(e){t("sweetness",e,!1)}),[]),c=Object(a.useMemo)((function(){return Object.keys(r).map((function(e){return{label:e,value:e}}))}),[]);return i.a.createElement(T.a,{style:{viewContainer:{flex:1,marginTop:"android"!==d.a.OS?16:0}},value:n.sweetness,items:c,onValueChange:function(e){l(e)}})}function I(e){var t=Object(b.b)(),n=t.values,r=t.setFieldValue,l=t.setFieldError,c=t.errors,u=Object(a.useState)(void 0===n[e.wineField]?"":String(n[e.wineField])),o=v()(u,2),s=o[0],f=o[1],m=Object(a.useCallback)((function(t){if(f(t),""!==t){var n=Number(t);isNaN(n)?l(e.wineField,"not a valid number"):r(e.wineField,n)}else r(e.wineField,void 0)}),[]);return i.a.createElement(p.e,{label:e.wineField,value:s,onChangeText:m,errorMessage:c[e.wineField]})}var M=n(438);function N(e){var t=Object(b.b)().values,n=Object(a.useContext)(c.a).manager,r=Object(a.useState)(t.image),l=v()(r,2),u=l[0],o=l[1];return Object(a.useEffect)((function(){u!==t.image&&o(t.image),!(null==u?void 0:u.startsWith("data:"))&&e.isVisible&&(null==n||n.downloadImage(u).then(o))}),[e.isVisible,t.image]),i.a.createElement(M.a,e,i.a.createElement(f.a,{style:{alignItems:"flex-start"}},i.a.createElement(p.d,{key:u,style:{width:200,height:200},source:{uri:u}}),i.a.createElement(p.a,{containerStyle:{width:"100%"},title:"Close",onPress:e.onBackdropPress})))}var U=n(14),q=n.n(U),G=n(505),W=n(439),J=n(22),K=n(509),L=function(e){var t;return q.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,q.a.awrap(e.takePictureAsync({quality:0,base64:!0}));case 2:return t=n.sent,n.abrupt("return",t.uri||"data:image/jpg;base64,"+t.base64);case 4:case"end":return n.stop()}}),null,null,null,Promise)};function Y(e){var t=Object(a.useRef)(null),n=Object(a.useState)(!1),r=v()(n,2),l=r[0],c=r[1],u=Object(a.useState)(!1),o=v()(u,2),s=o[0],m=o[1],w=Object(b.b)().setFieldValue;Object(a.useEffect)((function(){!l&&e.isVisible&&function(){var e,t;return q.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:if("web"!==d.a.OS){n.next=4;break}return n.next=3,q.a.awrap(K.a.isAvailableAsync());case 3:return n.abrupt("return",n.sent);case 4:return n.next=6,q.a.awrap(K.a.requestPermissionsAsync());case 6:return e=n.sent,t=e.status,n.abrupt("return","granted"===t);case 9:case"end":return n.stop()}}),null,null,null,Promise)}().then(c)}),[l,e.isVisible]);var y=Object(a.useCallback)((function(){return q.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=w,n.next=3,q.a.awrap(L(t.current));case 3:n.t1=n.sent,(0,n.t0)("image",n.t1),e.close();case 6:case"end":return n.stop()}}),null,null,null,Promise)}),[t]);return e.isVisible?i.a.createElement(f.a,{style:{flex:1}},i.a.createElement(K.a,{key:"re-mount-me-when-ready-to-fix-android-bug-"+s,style:{flex:1,maxWidth:400},useCamera2Api:!0,type:K.a.Constants.Type.back,ref:t,onCameraReady:function(){m(!0)}},!l&&i.a.createElement(J.a,null,"Camera not available."),i.a.createElement(f.a,{style:H.cameraButtonRow},i.a.createElement(p.a,{containerStyle:{width:"40%",marginRight:4},title:"Close",onPress:e.close}),i.a.createElement(p.a,{containerStyle:{width:"40%",marginLeft:4},title:"Take",disabled:!s,onPress:y})))):null}var H=m.a.create({cameraButtonRow:{flex:1,marginBottom:8,backgroundColor:"transparent",flexDirection:"row",justifyContent:"center",alignItems:"flex-end"}});function $(e){var t=Object(b.b)(),n=t.values,r=t.setFieldValue,l=Object(a.useState)(!1),c=v()(l,2),u=c[0],o=c[1],s=Object(a.useCallback)((function(){var e;return q.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,q.a.awrap(G.a({mediaTypes:W.a.All,quality:0}));case 2:if(!(e=t.sent).cancelled){t.next=5;break}return t.abrupt("return");case 5:r("image",e.uri);case 6:case"end":return t.stop()}}),null,null,null,Promise)}),[]),m=Object(a.useCallback)((function(){o(!1)}),[o]);return i.a.createElement(M.a,e,i.a.createElement(i.a.Fragment,null,i.a.createElement(f.a,null,i.a.createElement(p.d,{key:n.image,style:{width:250,height:250},source:{uri:n.image},PlaceholderContent:i.a.createElement(p.g,null,"...")}),i.a.createElement(f.a,{style:z.uploadRow},i.a.createElement(p.a,{containerStyle:{flexGrow:1,marginRight:4},title:"From disk",onPress:s}),i.a.createElement(p.a,{containerStyle:{flexGrow:1,marginLeft:4},title:"Take photo",onPress:function(){return o(!0)}})),i.a.createElement(p.a,{containerStyle:z.closeButton,title:"Close",onPress:e.onBackdropPress})),i.a.createElement(M.a,{isVisible:u,onBackdropPress:m,fullScreen:!0},i.a.createElement(Y,{isVisible:u,close:m}))))}var z=m.a.create({closeButton:{width:"100%",marginTop:8},uploadRow:{width:"100%",flexDirection:"row",marginTop:8}});function Q(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=R()(e);if(t){var a=R()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return k()(this,n)}}function X(){return i.a.createElement(p.e,{label:"Image",InputComponent:Z})}var Z=function(e){S()(n,e);var t=Q(n);function n(){return O()(this,n),t.apply(this,arguments)}return C()(n,[{key:"render",value:function(){return i.a.createElement(_,null)}}]),n}(i.a.Component);function _(){var e=Object(b.b)().values,t=Object(a.useState)(!1),n=v()(t,2),r=n[0],l=n[1],c=Object(a.useState)(!1),u=v()(c,2),o=u[0],s=u[1];return i.a.createElement(f.a,{style:ee.container},i.a.createElement(p.a,{title:"Show",disabled:!Boolean(e.image),containerStyle:ee.button,onPress:function(){l(!0)}}),i.a.createElement(p.a,{title:"Upload",containerStyle:ee.button,onPress:function(){s(!0)}}),i.a.createElement(N,{isVisible:r,onBackdropPress:function(){l(!1)}}),i.a.createElement($,{isVisible:o,onBackdropPress:function(){s(!1)}}))}var ee=m.a.create({container:{flex:1,flexDirection:"row",marginBottom:8},button:{flexGrow:1,borderRadius:8,marginTop:8,marginRight:8}});function te(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ne(e){var t=Object(a.useContext)(c.a).upsertWine,n=Object(a.useCallback)((function(n){return t(n,e.wine)}),[e.wine]);return i.a.createElement(f.a,{style:re.form},i.a.createElement(b.a,{initialValues:e.wine,onSubmit:function(e,t){n(e)}},(function(e){var t=e.handleSubmit,n=(e.values,e.isSubmitting),r=e.isValid,a=e.dirty;return i.a.createElement(s.a,null,i.a.createElement(h,null),i.a.createElement(w,{wineField:"color"}),i.a.createElement(D,null),i.a.createElement(w,{wineField:"area"}),i.a.createElement(w,{wineField:"grape"}),i.a.createElement(I,{wineField:"vintage"}),i.a.createElement(I,{wineField:"price"}),i.a.createElement(w,{wineField:"brand"}),i.a.createElement(w,{wineField:"comment"}),i.a.createElement(I,{wineField:"rating"}),i.a.createElement(X,null),i.a.createElement(p.a,{containerStyle:{paddingTop:8,width:"100%"},title:"Submit",onPress:t,disabled:n||!r||!a}))})))}var re=m.a.create({form:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?te(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):te(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({flex:1},"web"===d.a.OS?{alignItems:"center",justifyContent:"center",width:400}:{alignSelf:"stretch"})});function ae(){var e=Object(a.useContext)(c.a).wines[Object(l.g)().RowKey]||{RowKey:"-1",date:(new Date).getTime(),rating:-1,color:"red",sweetness:r["medium dry"]};return i.a.createElement(ne,{wine:e})}}}]);
//# sourceMappingURL=5.c20d54fe.chunk.js.map